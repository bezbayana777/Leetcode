// Big Countries
SELECT name, population, area FROM World 
WHERE area >= 3000000 OR population >= 25000000;



// Employee Bonus
SELECT name,bonus FROM Employee 
LEFT JOIN Bonus ON Employee.empID = Bonus.empID 
WHERE bonus<1000 OR bonus IS NULL;

// Not Boring Movies
SELECT * FROM Cinema 
WHERE id%2=1 AND description <> 'boring' ORDER BY rating DESC;


// Article Views
SELECT DISTINCT author_id AS id FROM Views 
WHERE author_id = viewer_id ORDER BY id;


//Average Selling Price
SELECT Prices.product_id, ROUND(IF(SUM(units)>0,SUM(price*units)/SUM(units),0),2) AS average_price FROM Prices LEFT JOIN UnitsSold ON Prices.product_id = UnitsSold.product_id AND purchase_date BETWEEN start_date AND end_date
GROUP BY Prices.product_id;


//Students and examinations

SELECT Students.student_id,student_name,Subjects.subject_name, COUNT(Examinations.subject_name) AS attended_exams FROM Students
CROSS JOIN Subjects LEFT JOIN Examinations ON Examinations.student_id = Students.student_id AND Subjects.subject_name = Examinations.subject_name 
GROUP BY Students.student_id,student_name,Subjects.subject_name ORDER BY Students.student_id,student_name,Subjects.subject_name;


// Movie Rating

(SELECT name AS results FROM Users INNER JOIN MovieRating ON Users.user_id = MovieRating.user_id GROUP BY MovieRating.user_id ORDER BY COUNT(MovieRating.user_id) DESC, name LIMIT 1)
UNION ALL
(SELECT title AS results FROM Movies INNER JOIN MovieRating ON Movies.movie_id = MovieRating.movie_id WHERE YEAR(created_at)=2020 AND MONTH(created_at)=2 GROUP BY title ORDER BY AVG(rating) DESC,title LIMIT 1);


// Customer
SELECT customer_id, count(customer_id) AS count_no_trans FROM Visits LEFT JOIN Transactions ON
Visits.visit_id = Transactions.visit_id WHERE transaction_id IS NULL GROUP BY customer_id ;
